{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///conversation.min.js","webpack:///webpack/bootstrap d211d61d8feff654beec","webpack:///./src/index.js","webpack:///./src/html.js"],"names":["root","factory","exports","module","define","amd","this","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","_interopRequireDefault","obj","__esModule","default","_toConsumableArray","arr","Array","isArray","i","arr2","length","from","_classCallCheck","instance","Constructor","TypeError","Object","defineProperty","value","_createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","key","protoProps","staticProps","prototype","_html","_html2","Conversation","configSelector","playerSelector","_this","typeDelay","arguments","undefined","animationClass","config","document","querySelector","player","blocks","concat","querySelectorAll","map","block","attributes","title","innerHTML","played","sentences","element","classes","forEach","cssClass","classList","add","questions","remove","answer","createElement","_addClasses","inner","appendChild","_playBlock","_this2","questionsInner","button","onclick","_answer","scrollIntoView","behavior","Math","random","letters","sentence","htmlMap","doneCallback","_this3","text","strip","shift","inject","setTimeout","_playLetter","_getTypeDelay","_this4","_playSentence","_this5","_showQuestions","filter","find","isVoidElement","tag","tagName","match","Boolean","voidElements","indexOf","toLowerCase","str","replace","regexp","tags","openers","result","exec","position","index","charAt","opener","pop","push","substr"],"mappings":"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","file":"conversation.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"conversationJS\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"conversationJS\"] = factory();\n\telse\n\t\troot[\"conversationJS\"] = factory();\n})(this, function() {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"conversationJS\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"conversationJS\"] = factory();\n\telse\n\t\troot[\"conversationJS\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _html = __webpack_require__(1);\n\t\n\tvar _html2 = _interopRequireDefault(_html);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Conversation = function () {\n\t  function Conversation(configSelector, playerSelector) {\n\t    var _this = this;\n\t\n\t    var typeDelay = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [25, 50];\n\t    var animationClass = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 'fadeInDown';\n\t\n\t    _classCallCheck(this, Conversation);\n\t\n\t    this.animationClass = animationClass;\n\t    this.typeDelay = typeDelay;\n\t    this.config = document.querySelector(configSelector);\n\t    this.player = document.querySelector(playerSelector);\n\t\n\t    // extract the main data structure\n\t    this.blocks = [].concat(_toConsumableArray(this.config.querySelectorAll('[step=\"0\"]'))).map(function (block) {\n\t      return {\n\t        id: block.attributes.block.value,\n\t        title: block.innerHTML,\n\t        played: false,\n\t        sentences: _this.config.querySelectorAll('[block=\"' + block.attributes.block.value + '\"]:not([step=\"0\"])')\n\t      };\n\t    });\n\t  }\n\t\n\t  _createClass(Conversation, [{\n\t    key: '_addClasses',\n\t    value: function _addClasses(element, classes) {\n\t      classes.forEach(function (cssClass) {\n\t        element.classList.add(cssClass);\n\t      });\n\t    }\n\t  }, {\n\t    key: '_answer',\n\t    value: function _answer(block) {\n\t      this.questions.remove();\n\t      var answer = document.createElement('div');\n\t      this._addClasses(answer, ['questions', 'answered']);\n\t      var inner = document.createElement('span');\n\t      inner.innerHTML = block.title;\n\t      answer.appendChild(inner);\n\t      this.player.appendChild(answer);\n\t      this._addClasses(answer, ['animated', 'fadeInLeft']);\n\t      this._playBlock(block);\n\t    }\n\t  }, {\n\t    key: '_showQuestions',\n\t    value: function _showQuestions(blocks) {\n\t      var _this2 = this;\n\t\n\t      if (blocks.length === 0) return;\n\t      this.questions = document.createElement('div');\n\t      this.questions.classList.add('questions');\n\t      var questionsInner = document.createElement('div');\n\t      this.questions.appendChild(questionsInner);\n\t      blocks.forEach(function (block) {\n\t        var button = document.createElement('button');\n\t        button.innerHTML = block.title;\n\t        button.onclick = function () {\n\t          _this2._answer(block);\n\t        };\n\t        questionsInner.appendChild(button);\n\t      });\n\t      this.player.appendChild(this.questions);\n\t      this.questions.scrollIntoView({ behavior: 'smooth' });\n\t      this._addClasses(this.questions, ['animated', 'fadeInUp']);\n\t    }\n\t  }, {\n\t    key: '_getTypeDelay',\n\t    value: function _getTypeDelay() {\n\t      return Math.random() * (this.typeDelay[1] - this.typeDelay[0]) + this.typeDelay[0];\n\t    }\n\t  }, {\n\t    key: '_playLetter',\n\t    value: function _playLetter(letters, sentence, htmlMap, doneCallback) {\n\t      var _this3 = this;\n\t\n\t      if (letters.length === 0) {\n\t        return doneCallback();\n\t      }\n\t      var text = _html2.default.strip(sentence.innerHTML) + letters.shift();\n\t      sentence.innerHTML = _html2.default.inject(text, htmlMap);\n\t      // schedule the next letter after type delay\n\t      setTimeout(function () {\n\t        _this3._playLetter(letters, sentence, htmlMap, doneCallback);\n\t      }, this._getTypeDelay());\n\t    }\n\t  }, {\n\t    key: '_playSentence',\n\t    value: function _playSentence(sentences, doneCallback) {\n\t      var _this4 = this;\n\t\n\t      if (sentences.length === 0) {\n\t        return doneCallback();\n\t      }\n\t      var sentence = sentences.shift();\n\t      // inject a span to allow flexbox centering\n\t      var text = '<span>' + sentence.innerHTML + '</span>';\n\t      var htmlMap = _html2.default.map(text);\n\t      var letters = [].concat(_toConsumableArray(_html2.default.strip(text)));\n\t      sentence.innerHTML = '';\n\t      this._playLetter(letters, sentence, htmlMap, function () {\n\t        // this sentence has finished playing, queue the next\n\t        sentence.classList.remove('is-typing');\n\t        _this4._playSentence(sentences, doneCallback);\n\t      });\n\t      sentence.classList.add('is-typing');\n\t      this.player.appendChild(sentence);\n\t      sentence.scrollIntoView({ behavior: 'smooth' });\n\t      // flipInX\n\t      this._addClasses(sentence, ['animated', this.animationClass]);\n\t    }\n\t  }, {\n\t    key: '_playBlock',\n\t    value: function _playBlock(block) {\n\t      var _this5 = this;\n\t\n\t      block.played = true;\n\t      this._playSentence([].concat(_toConsumableArray(block.sentences)), function () {\n\t        _this5._showQuestions(_this5.blocks.filter(function (block) {\n\t          return !block.played;\n\t        }));\n\t      });\n\t    }\n\t  }, {\n\t    key: 'play',\n\t    value: function play() {\n\t      this._playBlock(this.blocks.find(function (block) {\n\t        return block.id === 'start';\n\t      }));\n\t    }\n\t  }]);\n\t\n\t  return Conversation;\n\t}();\n\t\n\texports.default = Conversation;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 1 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\tvar voidElements = ['area', 'base', 'br', 'col', 'embed', 'hr', 'img', 'input', 'keygen', 'link', 'menuitem', 'meta', 'param', 'source', 'track', 'wbr'];\n\t\n\tfunction isVoidElement(tag) {\n\t  var tagName = tag.match(/<([^\\s>]+)/);\n\t  return Boolean(tagName) && voidElements.indexOf(tagName[1].toLowerCase()) > -1;\n\t}\n\t\n\texports.default = {\n\t  strip: function strip(str) {\n\t    return str.replace(/(<([^>]+)>)/gi, '');\n\t  },\n\t  map: function map(str) {\n\t    var regexp = /<[^>]+>/gi;\n\t    var tags = [];\n\t    var openers = [];\n\t    var result = void 0;\n\t    var tag = void 0;\n\t\n\t    while (result = regexp.exec(str)) {\n\t      tag = {\n\t        tagName: result[0],\n\t        position: result.index\n\t      };\n\t\n\t      if (tag.tagName.charAt(1) === '/') {\n\t        tag.opener = openers.pop();\n\t      } else if (tag.tagName.charAt(tag.tagName.length - 2) !== '/' && !isVoidElement(tag.tagName)) {\n\t        openers.push(tag);\n\t      }\n\t\n\t      tags.push(tag);\n\t    }\n\t\n\t    return tags;\n\t  },\n\t  inject: function inject(str, map) {\n\t    for (var i = 0, tag; i < map.length; i++) {\n\t      tag = map[i];\n\t\n\t      if (str.length > 0 && tag.position <= str.length) {\n\t        str = str.substr(0, tag.position) + tag.tagName + str.substr(tag.position);\n\t      } else if (tag.opener && tag.opener.position < str.length) {\n\t        str += tag.tagName;\n\t      }\n\t    }\n\t\n\t    return str;\n\t  }\n\t};\n\tmodule.exports = exports['default'];\n\n/***/ }\n/******/ ])\n});\n;\n\n\n/** WEBPACK FOOTER **\n ** conversation.min.js\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap d211d61d8feff654beec\n **/","import html from './html'\n\nexport default class Conversation {\n  constructor (configSelector, playerSelector, typeDelay = [25, 50], animationClass = 'fadeInDown') {\n    this.animationClass = animationClass\n    this.typeDelay = typeDelay\n    this.config = document.querySelector(configSelector)\n    this.player = document.querySelector(playerSelector)\n\n    // extract the main data structure\n    this.blocks = [...this.config.querySelectorAll('[step=\"0\"]')].map(block => {\n      return {\n        id: block.attributes.block.value,\n        title: block.innerHTML,\n        played: false,\n        sentences: this.config.querySelectorAll(`[block=\"${block.attributes.block.value}\"]:not([step=\"0\"])`)\n      }\n    })\n  }\n\n  _addClasses (element, classes) {\n    classes.forEach(cssClass => {\n      element.classList.add(cssClass)\n    })\n  }\n\n  _answer (block) {\n    this.questions.remove()\n    let answer = document.createElement('div')\n    this._addClasses(answer, ['questions', 'answered'])\n    let inner = document.createElement('span')\n    inner.innerHTML = block.title\n    answer.appendChild(inner)\n    this.player.appendChild(answer)\n    this._addClasses(answer, ['animated', 'fadeInLeft'])\n    this._playBlock(block)\n  }\n\n  _showQuestions (blocks) {\n    if (blocks.length === 0) return\n    this.questions = document.createElement('div')\n    this.questions.classList.add('questions')\n    let questionsInner = document.createElement('div')\n    this.questions.appendChild(questionsInner)\n    blocks.forEach(block => {\n      let button = document.createElement('button')\n      button.innerHTML = block.title\n      button.onclick = () => { this._answer(block) }\n      questionsInner.appendChild(button)\n    })\n    this.player.appendChild(this.questions)\n    this.questions.scrollIntoView({behavior: 'smooth'})\n    this._addClasses(this.questions, ['animated', 'fadeInUp'])\n  }\n\n  _getTypeDelay () {\n    return Math.random() * (this.typeDelay[1] - this.typeDelay[0]) + this.typeDelay[0]\n  }\n\n  _playLetter (letters, sentence, htmlMap, doneCallback) {\n    if (letters.length === 0) {\n      return doneCallback()\n    }\n    let text = html.strip(sentence.innerHTML) + letters.shift()\n    sentence.innerHTML = html.inject(text, htmlMap)\n    // schedule the next letter after type delay\n    setTimeout(() => {\n      this._playLetter(letters, sentence, htmlMap, doneCallback)\n    }, this._getTypeDelay())\n  }\n\n  _playSentence (sentences, doneCallback) {\n    if (sentences.length === 0) {\n      return doneCallback()\n    }\n    let sentence = sentences.shift()\n    // inject a span to allow flexbox centering\n    let text = `<span>${sentence.innerHTML}</span>`\n    let htmlMap = html.map(text)\n    let letters = [...html.strip(text)]\n    sentence.innerHTML = ''\n    this._playLetter(letters, sentence, htmlMap, () => {\n      // this sentence has finished playing, queue the next\n      sentence.classList.remove('is-typing')\n      this._playSentence(sentences, doneCallback)\n    })\n    sentence.classList.add('is-typing')\n    this.player.appendChild(sentence)\n    sentence.scrollIntoView({behavior: 'smooth'})\n    // flipInX\n    this._addClasses(sentence, ['animated', this.animationClass])\n  }\n\n  _playBlock (block) {\n    block.played = true\n    this._playSentence([...block.sentences], () => {\n      this._showQuestions(this.blocks.filter(block => !block.played))\n    })\n  }\n\n  play () {\n    this._playBlock(this.blocks.find(block => block.id === 'start'))\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/index.js\n **/","let voidElements = [\n  'area',\n  'base',\n  'br',\n  'col',\n  'embed',\n  'hr',\n  'img',\n  'input',\n  'keygen',\n  'link',\n  'menuitem',\n  'meta',\n  'param',\n  'source',\n  'track',\n  'wbr'\n]\n\nfunction isVoidElement (tag) {\n  const tagName = tag.match(/<([^\\s>]+)/)\n  return Boolean(tagName) && voidElements.indexOf(tagName[1].toLowerCase()) > -1\n}\n\nexport default {\n  strip (str) {\n    return str.replace(/(<([^>]+)>)/gi, '')\n  },\n\n  map (str) {\n    let regexp = /<[^>]+>/gi\n    let tags = []\n    let openers = []\n    let result\n    let tag\n\n    while ((result = regexp.exec(str))) {\n      tag = {\n        tagName: result[0],\n        position: result.index\n      }\n\n      if (tag.tagName.charAt(1) === '/') {\n        tag.opener = openers.pop()\n      } else if (tag.tagName.charAt(tag.tagName.length - 2) !== '/' && !isVoidElement(tag.tagName)) {\n        openers.push(tag)\n      }\n\n      tags.push(tag)\n    }\n\n    return tags\n  },\n\n  inject (str, map) {\n    for (let i = 0, tag; i < map.length; i++) {\n      tag = map[i]\n\n      if (str.length > 0 && tag.position <= str.length) {\n        str = str.substr(0, tag.position) + tag.tagName + str.substr(tag.position)\n      } else if (tag.opener && tag.opener.position < str.length) {\n        str += tag.tagName\n      }\n    }\n\n    return str\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./src/html.js\n **/"],"sourceRoot":""}